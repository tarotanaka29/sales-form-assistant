# 変更履歴

## Version 1.0.7 (2025-10-14)

### 個別入力モードの動作改善

#### 問題の修正

**問題:**
- 個別入力モードでボタンをクリックしても、フォームに内容が反映されない

**原因:**
- フレームワーク(React/Vue等)で構築されたフォームでは、通常のvalue設定だけでは不十分
- イベントのトリガーが不足していた

**修正内容:**

1. **フレームワーク対応の強化**
   - `HTMLInputElement.prototype.value`のネイティブセッターを使用
   - より確実に値を設定できるように改善

2. **イベントトリガーの追加**
   - `input`、`change`、`blur`イベントに加えて
   - `keydown`、`keyup`イベントも追加
   - フレームワークの変更検知を確実にトリガー

3. **デバッグログの追加**
   - フィールド判別の過程をコンソールに出力
   - トラブルシューティングが容易に

4. **ふりがな分割処理の追加**
   - `popup.js`に`splitKana()`関数を追加
   - `kanaLastName`、`kanaFirstName`の個別入力に対応

5. **フィードバックの改善**
   - 入力成功時に入力したフィールド数を表示
   - より詳細な状態通知

#### 技術的な変更

**修正ファイル一覧:**

1. **content/content.js**
   - `fillSingleFieldByType()`メソッドを改善
   - ネイティブセッターを使用した値設定
   - デバッグログの追加
   - 追加イベントのトリガー

2. **popup/popup.js**
   - `splitKana()`関数を追加
   - `kanaLastName`、`kanaFirstName`の分割処理を追加

#### 期待される効果

- ✅ React/Vue等のフレームワークで構築されたフォームでも確実に入力
- ✅ より多くのフォームで個別入力モードが正常に動作
- ✅ デバッグログでトラブルシューティングが容易に

---

## Version 1.0.6 (2025-10-14)

### フィールド判別ロジックの改善

#### 問題の修正

**問題:** 
- https://jkk-technologies.com/contact のフォームで「企業名/組織名」フィールドに「名」(firstName)が誤って入力される

**原因:**
- フィールド判別時に「企業名/組織名」のラベルテキストに含まれる「名」という文字が「firstName」のキーワードとマッチしていた
- フィールドタイプの優先順位が適切でなかった

**修正内容:**

1. **フィールドマッピングの優先順位変更**
   - `companyName`を最優先で判別するようマッピングテーブルの先頭に配置
   - 「組織名」「企業」「貴社名」「御社名」などのキーワードを追加

2. **フィールド判別ロジックの改善**
   - ラベルテキストを最優先で評価
   - 属性の評価順序を明確化: ラベル > name > id > placeholder > className
   - 「名」が「企業名」「組織名」「会社名」の一部として含まれる場合は`firstName`として判別しないよう除外ロジックを追加

3. **ラベルテキスト取得の改善**
   - テキストのトリミング処理を追加
   - 短いテキスト（50文字未満）のみをラベルとして採用

#### 技術的な変更

**修正ファイル一覧:**

1. **utils/field-mapping.js**
   - `companyName`のマッピングを先頭に配置
   - 「組織名」「企業」などのキーワードを追加
   - `fullName`から「name」キーワードを削除（誤判別防止）

2. **content/field-detector.js**
   - `detectFieldType()`メソッドを改善
   - 属性評価の優先順位を明確化
   - 「名」が会社名の一部として含まれる場合の除外ロジックを追加
   - `getLabelText()`メソッドにトリミング処理を追加

#### 期待される効果

- 「企業名/組織名」フィールドに正しく会社名が入力される
- 「お名前」フィールドには引き続き氏名が入力される
- より正確なフィールド判別が可能に

---

## Version 1.0.5 (2025-10-14)

### ふりがな表示順序の変更

#### 主な変更

- ふりがなの表示順序を名前、フリガナと同じ順番に変更
- **変更前:** ふりがな１、ふりがな２ → ふりがな(フル)
- **変更後:** ふりがな(フル) → ふりがな１、ふりがな２

---

## Version 1.0.5 (2025-10-14)

### ふりがな(フル)フィールドの追加

#### 主な変更

1. **ふりがな(フル)フィールドの追加**
   - 担当者情報セクションに「ふりがな(フル)」フィールドを追加
   - 既存の「ふりがな１」「ふりがな２」と同様に、フル形式でも入力可能に

2. **自動分割機能の拡張**
   - `AutoSplit.splitKana()` 関数を追加
   - 「ふりがな(フル)」から「ふりがな１」「ふりがな２」への自動分割に対応
   - スペース区切りまたは自動判別で姓名を分割

3. **フィールドマッピングの追加**
   - `kanaFullName` のマッピングを追加
   - 「ふりがな」「ふりがな(フル)」「kana」「furigana」などのキーワードで検出

#### 対応項目(28項目)

**担当者情報:**
- 姓、名、名前(フル)
- ふりがな(フル)、ふりがな１、ふりがな２
- フリガナ(フル)、フリガナ１、フリガナ２

---

## Version 1.0.4 (2025-10-14)

### 問い合わせ内容の最適化

#### 主な変更

1. **問い合わせ内容(標準)の削除**
   - 「問い合わせ内容(標準)」フィールドを削除
   - よりシンプルで明確な構成に変更

2. **Ctrl+B自動入力の優先順位変更**
   - 通常の「問い合わせ内容」フィールドには**問い合わせ内容(最大800文字)**を優先的に入力
   - より詳細な内容を標準として入力することで、情報量を最大化

---

## Version 1.0.3 (2025-10-14)

### BtoB営業代行ツールへの最適化

このツールは個人向けではなく、**BtoB営業代行業務**向けに設計されています。

#### 主な変更

1. **UI構成の変更**
   - 「個人情報」と「住所・連絡先」を「会社情報」セクションに統合
   - 「担当者情報」セクションを独立して配置
   - BtoBビジネスに適した情報構造に再編成

2. **年齢フィールドの削除**
   - ビジネス用途では不要な「年齢」フィールドを削除

---

## Version 1.0.2 (2025-10-14)

### 新機能: 個別入力モード

自動入力がうまくいかないフォームに対応するため、**個別入力モード**を追加しました。

---

## Version 1.0.1 (2025-10-14)

### 追加機能

#### 1. フリガナの分割入力対応
- **フリガナ1(姓)** と **フリガナ2(名)** の2つの入力項目を追加

#### 2. 郵便番号の分割入力対応
- **郵便番号(フル)**: 統合入力 (例: 123-4567)
- **郵便番号1**: 3桁の数字
- **郵便番号2**: 4桁の数字

#### 3. 電話番号の分割入力対応
- **電話番号(フル)**: 統合入力 (例: 090-2256-8456)
- **電話番号1**: 市外局番部分
- **電話番号2**: 市内局番部分
- **電話番号3**: 加入者番号部分

---

## Version 1.0.0 (2025-10-14)

### 初回リリース

- 27項目の自動入力機能
- Ctrl+Bショートカット
- フィールド自動判別
- 設定画面
- テストフォーム

